var v=$('script:last').data('values');if(typeof v!=='object'||(typeof v==='object'&&(v.orderSummaryUrl==undefined||!v.orderSummaryUrl)))
{v=libraryValues!=undefined?libraryValues:{};}
function getSummaryData(cartUpdate,cart,target)
{data={};data.shipping_country=$('#_shippingCountry').val()?$('#_shippingCountry').val():'';data.shipping_region=$('#_shippingRegion').val()?$('#_shippingRegion').val():'';data.shipping_city=$('#_shippingCity').val()?$('#_shippingCity').val():'';data.shipping_method=$('._shippingMethod:checked').val()?$('._shippingMethod:checked').val():'';data.shipping_zipcode=$('#_shippingZipcode').val()?$('#_shippingZipcode').val():'';data.region_name=$('#_shippingRegionName').val()?$('#_shippingRegionName').val():'';data.city_name=$('#_shippingCityName').val()?$('#_shippingCityName').val():'';data.updateType='shippingCountry';data.payment=$('.pay-method:checked').val()?$('.pay-method:checked').val():'';data.voucher=$('#voucherValue').val()?$('#voucherValue').val():'';data.customerPoints=$('#customer_points').val()?$('#customer_points').val():'';data.orderSummaryUrl=v.orderSummaryUrl;data.target=target;data.cartUpdate=cartUpdate!==undefined?cartUpdate:'';data.cart=cart!==undefined?cart:'';data.lockerId=$('#_shippingLocker').length?$('#_shippingLocker').val():'';data.lockerSupportedPaymentType=$('#_shippingLockerSupportedPaymentType').length?$('#_shippingLockerSupportedPaymentType').val():'';data.billingType=$('.changeBillingAddress').is(':checked')&&$('.juridicP').is(':checked')?'company':'enduser';return data;}
$.Gomag.bind('Order/Summary/Complete',function orderSummaryCompleteLibrary(response,data){data=data.properties;if(data.cartSummaryHtml!='')
{$('.-g-checkout-summary').html(data.cartSummaryHtml);$.Gomag.trigger('Order/Summary/Items/Add/After');}
if($.Gomag.getVoucherFieldDisplayOption()=='block')
{$('.form-cpn').css('display','block');}
if(data.cartVoucherError!==false)
{var html='';$.each(data.cartVoucherError,function(i,v){html+='<p><span style="color:#ff0000; font-size:12px;">'+v+'</span></p>';})
$('.cupon-error').html(html);}
else
{$('.cupon-error').html('');}})
$(document).ready(function(){$(document).on('click','.cupon-t',function(e){e.stopImmediatePropagation();$('.form-cpn').slideToggle(200);setTimeout(function()
{$.Gomag.setVoucherFieldDisplayOption($(".form-cpn").css("display"));},300);})
$(document).on('click','#_submit_voucher',function(e){e.preventDefault();$('#_voucherApplied').val(1);$.Gomag.initOrderSummartyUpdate(getSummaryData(undefined,undefined,$('.cart-head').data('target')));})
$(document).on('click','.prod-option',function(){$(this).next().slideToggle();if($(this).find('i.fa').hasClass('fa-angle-down')){$(this).find('i.fa').removeClass('fa-angle-down').addClass('fa-angle-up');}else{$(this).find('i.fa').removeClass('fa-angle-up').addClass('fa-angle-down');}});var parse=function(type,number){return type=='float'?parseFloat(number):parseInt(number);};var quantityUpdateClick;$(document).on('click','.updateCart',function(e){var target=$(this).data('target');var idfc=$(this).data('idfc');e.preventDefault();clearTimeout(quantityUpdateClick);x=$(this).siblings('input[name^="quantity"]');var initialQuantity=x.val();var id=x.attr('id').replace('quantity_','');var stepType=$(this).attr('rel');var stepQ=$(this).siblings('input[name^="sq"]');var minimOQ=$(this).siblings('input[name^="sqm"]');var maxQty=$('#quantity_'+id).val();if(parseFloat(stepQ.val())%1!==0||parseFloat(x.val())%1!==0){var type='float';var fixedCount=$.Gomag.productsStockDecimals;}else{var type='int';var fixedCount=0;}
var updateType=$(this).attr('rel');stepQ=parse(type,stepQ.val())>0?parse(type,stepQ.val()):1;minimOQ=parse(type,minimOQ.val())>0?parse(type,minimOQ.val()):1;if($(this).attr('rel')=='-'&&(parse(type,x.val())-stepQ)<minimOQ)
{x.val(0);var cart={'remove_product':id};var productId=$(this).data('product');var productQuantity=$(this).data('qty');var data={};data.product=productId;data.quantity=productQuantity;var cartUpdate=1;$.Gomag.trigger('Product/Remove/From/Cart',{data:data});$.Gomag.initOrderSummartyUpdate(getSummaryData(cartUpdate,cart,target));hideRemovedExtraService(idfc);return false;}
var newQuantity=($(this).attr('rel')=='+'?parse(type,x.val())+stepQ:(parse(type,x.val())-stepQ)<minimOQ?minimOQ:parse(type,x.val())-stepQ).toFixed(fixedCount);if(newQuantity.indexOf(".")>=0){newQuantity=newQuantity.replace(/0+$/g,'');newQuantity=newQuantity.replace(/\.$/g,'');}
x.val(newQuantity);var rule=[];var k=[];var p=[];var parent=[];var q=[];var configurations=[];k.push(id);p.push($('#_productId_'+id).val());parent.push($('#_parentId_'+id).val());q.push(x.val());rule.push($('#_ruleId_'+id).val());var ruleId=$('#_ruleId_'+id).val();$('._parentId').each(function(){if($(this).val()==$('#_productId_'+id).val()){var childKey=$(this).attr('id').replace('_parentId_','');var childRuleId=$('#_ruleId_'+childKey).val();if(parseInt(ruleId)==parseInt(childRuleId)){var parentRequiredQty=$('#parentRequiredQty_'+childKey).val();var itemQty=$('#packageItemQuantity_'+childKey).val();var parentQty=x.val();var diffMod=parse(type,parentQty)%parse(type,parentRequiredQty);if(updateType=='+'){var addQty=$('#quantityToAdd_'+childKey).val();if(diffMod==0){addQty=(parse(type,addQty)+parse(type,itemQty)).toFixed(fixedCount);}}else{var addQty=$('#quantityToAdd_'+childKey).val();if(diffMod!=0){addQty=parse(type,addQty)-itemQty;}}
k.push(childKey);p.push($('#_productId_'+childKey).val());parent.push($('#_parentId_'+childKey).val());q.push(addQty);rule.push($('#_ruleId_'+childKey).val());}}});var cart={'key':k,'product':p,'quantity':q,'parent':parent,'rule':rule,'product_configurations':configurations};var cartUpdate=1;var data={};data.product=$('#_productId_'+id).val();data.initialQuantity=initialQuantity;data.finalQuantity=x.val();quantityUpdateClick=setTimeout(function(event){$.Gomag.trigger('Cart/Quantity/Update',{data:data});$.Gomag.initOrderSummartyUpdate(getSummaryData(cartUpdate,cart,target));},1500);});$(document).on('click',$GomagConfig.checkoutItemRemoveButton,function(e){e.preventDefault();var id=$(this).attr('id').replace('__checkoutItemRemove','');var cart={'remove_product':id};var productId=$(this).data('product');var productQuantity=$(this).data('qty');var data={};data.product=productId;data.quantity=productQuantity;var cartUpdate=1;$.Gomag.trigger('Product/Remove/From/Cart',{data:data});$.Gomag.initOrderSummartyUpdate(getSummaryData(cartUpdate,cart,$(this).data('target')));hideRemovedExtraService(id);});function hideRemovedExtraService(itemCartId){var checkboxElement=$('input.__serviceOption'+itemCartId);var dataId=checkboxElement.data('id');if($('#__serviceNotes'+dataId).length){$('#__serviceNotes'+dataId).addClass('hide');}
checkboxElement.prop('checked',false);var selectElement=$('select.__selectServiceOption:has(option[data-cart="'+itemCartId+'"])');var defaultOption=selectElement.find('option:first');defaultOption.prop('selected',true);var dataId=defaultOption.data('id');if($('#__serviceNotes'+dataId).length){$('#__serviceNotes'+dataId).addClass('hide');}}})